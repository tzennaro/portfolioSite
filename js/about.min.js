"use strict";d3.json("./data/about.json",function(t,e){var a=1110,n=1250,r=75,i=d3.time.format("%Y-%m-%d").parse,c=d3.select("#about-graph-container").append("svg").attr("viewBox","0 0 "+a+" "+n).attr("preserveAspectRatio","xMaxYMin").attr("meetOrSlice","meet").append("g").attr("id","about-graph-group");c.append("clipPath").attr("id","about-area").append("rect").attr("x","0").attr("y",r).attr("width",a).attr("height",n-2*r);var s=i("2008-08-01"),o=new Date,l=o.getDate(),d=o.getMonth()+1,p=o.getFullYear();10>l&&(l="0"+l),10>d&&(d="0"+d);var u=i(p+"-"+d+"-"+l),y=d3.time.scale().domain([s,u]).range([n-r,r]),g=d3.scale.ordinal().domain(["education","work","experience","interests"]).rangeRoundBands([r,a-r]),f=d3.scale.ordinal().domain(["rect-sscs","rect-typemetrics","rect-blackmountaincollege_infographics","rect-atlas_urbino","rect-wttc","rect-death_in_venice","rect-sansavenir"]).range(["#sscs","#typemetrics","#blackmountaincollege_infographics","#atlas_urbino","#wttc_infographics","#death_in_venice","#sansavenir"]),h=d3.svg.axis().scale(g).orient("top"),x=d3.svg.axis().scale(y).ticks(20).tickFormat(d3.time.format("%b '%y")).orient("left"),m=_.uniq(e.map(function(t){return t.type}));c.selectAll(".rectGroup").data(m).enter().append("g").attr("class","rectGroup").attr("clip-path","url(#about-area)").attr("id",function(t){return"rect-"+t}),c.selectAll(".textGroup").data(m).enter().append("g").attr("class","textGroup").attr("id",function(t){return"text-"+t}),c.selectAll(".rectGroup").each(function(){var t=this.id,a=e.filter(function(e){return"rect-education"===t?"education"===e.type:"rect-work"===t?"work"===e.type:"rect-experience"===t?"experience"===e.type:"rect-interests"===t?"interests"===e.type:void 0});d3.select(this).selectAll("rect").data(a).enter().append("rect").attr({id:function(t){return t.id},"class":function(){return"sub"+t},x:function(t,e){return"work"===t.type||"education"===t.type?g(t.type):"interests"===t.type?g(t.type)+(g.rangeBand()/a.length+5)*e+g.rangeBand()/a.length/2-7:g(t.type)+g.rangeBand()/a.length*e},y:function(t){return y(i(t.dateEnd))},height:function(t){return y(i(t.dateStart))-y(i(t.dateEnd))},width:function(t){return"education"===t.type?g.rangeBand()-2:"work"===t.type?g.rangeBand()-2:"interests"===t.type?2:g.rangeBand()/a.length-2},fill:function(t){return"education"===t.type?"#FF3F4C":"work"===t.type?"#72ff80":"experience"===t.type?"#59d0ff":"interests"===t.type?"#353531":void 0},opacity:.25}),"rect-interests"===this.id&&d3.select(this).selectAll("circle").data(a).enter().append("circle").attr({cy:function(t){return i(t.dateStart)<=s?n-r+5:y(i(t.dateStart))+4},cx:function(t,e){return g(t.type)+(g.rangeBand()/a.length+5)*e+g.rangeBand()/a.length/2-6},r:4,stroke:"#353531","stroke-width":2,fill:"#F4F7F5",opacity:.35}),"rect-work"===this.id&&d3.select(this).selectAll("rect").on("mouseover",function(){d3.select(this).transition().duration(150).attr({cursor:"pointer",opacity:1})}).on("mouseout",function(){d3.select(this).transition().duration(150).attr({opacity:.35})}).on("click",function(t){$(f(t.id)).modal()})}),c.selectAll(".textGroup").each(function(){function t(t,e){t.each(function(){for(var t,a=d3.select(this),n=a.text().split(/\s+/).reverse(),r=[],i=0,c=1.2,s=a.attr("x"),o=a.attr("y"),l=a.attr("dy")?a.attr("dy"):0,d=a.text(null).append("tspan").attr("x",s).attr("y",o).attr("dy",l+"em");t=n.pop();)r.push(t),d.text(r.join(" ")),d.node().getComputedTextLength()>e&&(r.pop(),d.text(r.join(" ")),r=[t],d=a.append("tspan").attr("x",s).attr("y",o).attr("dy",++i*c+l+"em").text(t))})}var a=this.id,c=e.filter(function(t){return"text-education"===a?"education"===t.type:"text-work"===a?"work"===t.type:"text-experience"===a?"experience"===t.type:"text-interests"===a?"interests"===t.type:void 0}),o=d3.select(this).selectAll("text").data(c).enter().append("text").attr({"font-family":"FontAwesome, Roboto, serif","pointer-events":"none","font-weight":"regular","font-size":"11px",color:"#353531","class":function(t){return"labelClass-"+t.type},x:function(t,e){return"work"===t.type||"education"===t.type?g(t.type):"experience"===t.type?g(t.type)+g.rangeBand()/c.length*e:g(t.type)+(g.rangeBand()/c.length+5)*e+g.rangeBand()/c.length/2-3},y:function(t,e){return i(t.dateStart)<=s?n-r-2-15*e:y(i(t.dateStart))-2}}).text(function(t){return"interests"===t.type?t.icon+" "+t.name:t.name});"labelClass-work"===o.attr("class")||"labelClass-education"===o.attr("class")?o.call(t,g.rangeBand()):"labelClass-experience"===o.attr("class")&&o.call(t,g.rangeBand()/1.5)}),c.append("g").attr("class","axis").attr("id","xaxis").attr("transform","translate(0, "+r+")").call(h),c.append("g").attr("class","axis").attr("id","yaxis").attr("transform","translate("+r+", 0)").call(x)});"use strict";d3.json("./data/about.json",function(t,e){var r=1140,a=1409,n=55,i=d3.time.format("%Y-%m-%d").parse,c=d3.select("#about-graph-container").append("svg").attr("viewBox","0 0 "+r+" "+a).attr("preserveAspectRatio","xMaxYMin").attr("meetOrSlice","meet");c.append("clipPath").attr("id","about-area").append("rect").attr("x",n).attr("y",n).attr("width",r).attr("height",a-2*n);var s=i("2008-08-01"),l=new Date,o=l.getDate(),d=l.getMonth()+1,p=l.getFullYear();10>o&&(o="0"+o),10>d&&(d="0"+d);var u=i(p+"-"+d+"-"+o),y=d3.time.scale().domain([s,u]).range([a-n,n]),x=d3.scale.ordinal().domain(["education","work","experience","interests"]).rangeRoundBands([n,r-n]),g=textures.lines().lighter().thicker().orientation("3/8").stroke("#F4F7F5").background("#FF3F4C"),f=textures.lines().lighter().thicker().orientation("3/8").stroke("#F4F7F5").background("#72ff80"),h=textures.lines().lighter().thicker().orientation("3/8").stroke("#F4F7F5").background("#59d0ff"),k=d3.svg.axis().scale(x).orient("top"),m=d3.svg.axis().scale(y).ticks(20).tickFormat(d3.time.format("%b '%y")).orient("left");c.append("g").attr("class","axis").attr("id","xaxis").attr("transform","translate(0, "+n+")").call(k),c.append("g").attr("class","axis").attr("id","yaxis").attr("transform","translate("+n+", 0)").call(m);var F=_.uniq(e.map(function(t){return t.type}));c.selectAll(".rectGroup").data(F).enter().append("g").attr("class","rectGroup").attr("clip-path","url(#about-area)").attr("id",function(t){return"rect-"+t}),c.selectAll(".textGroup").data(F).enter().append("g").attr("class","textGroup").attr("clip-path","url(#about-area)").attr("id",function(t){return"text-"+t}),c.selectAll(".rectGroup").each(function(){var t=this.id,r=e.filter(function(e){return"rect-education"===t?"education"===e.type:"rect-work"===t?"work"===e.type:"rect-experience"===t?"experience"===e.type:"rect-interests"===t?"interests"===e.type:void 0});d3.select(this).selectAll("rect").data(r).enter().append("rect").attr({id:function(t){return t.id},"class":function(){return"sub"+t},x:function(t,e){return"work"===t.type||"education"===t.type?x(t.type):"interests"===t.type?x(t.type)+(x.rangeBand()/r.length+5)*e+x.rangeBand()/r.length/2:x(t.type)+x.rangeBand()/r.length*e},y:function(t){return y(i(t.dateEnd))},height:function(t){return y(i(t.dateStart))-y(i(t.dateEnd))},width:function(t){return"work"===t.type||"education"===t.type?x.rangeBand()-2:"interests"===t.type?1:x.rangeBand()/r.length-2},fill:function(t){return"education"===t.type?(c.call(g),g.url()):"work"===t.type?(c.call(f),f.url()):"experience"===t.type?(c.call(h),h.url()):"interests"===t.type?"#353531":void 0},opacity:.35}),"rect-interests"===this.id&&d3.select(this).selectAll("circle").data(r).enter().append("circle").attr({cy:function(t){return i(t.dateStart)<=s?a-n+5:y(i(t.dateStart))+4},cx:function(t,e){return x(t.type)+(x.rangeBand()/r.length+5)*e+x.rangeBand()/r.length/2+1},r:4,stroke:"#353531","stroke-width":1,fill:"#F4F7F5",opacity:.35})}),c.selectAll(".textGroup").each(function(){function t(t,e){t.each(function(){for(var t,r=d3.select(this),a=r.text().split(/\s+/).reverse(),n=[],i=0,c=1.2,s=r.attr("x"),l=r.attr("y"),o=r.attr("dy")?r.attr("dy"):0,d=r.text(null).append("tspan").attr("x",s).attr("y",l).attr("dy",o+"em");t=a.pop();)n.push(t),d.text(n.join(" ")),d.node().getComputedTextLength()>e&&(n.pop(),d.text(n.join(" ")),n=[t],d=r.append("tspan").attr("x",s).attr("y",l).attr("dy",++i*c+o+"em").text(t))})}var r=this.id,c=e.filter(function(t){return"text-education"===r?"education"===t.type:"text-work"===r?"work"===t.type:"text-experience"===r?"experience"===t.type:"text-interests"===r?"interests"===t.type:void 0}),l=d3.select(this).selectAll("text").data(c).enter().append("text").attr({"font-family":"FontAwesome, Roboto, serif",color:"#353531","class":function(t){return"labelClass-"+t.type},x:function(t,e){return"work"===t.type||"education"===t.type?x(t.type):"experience"===t.type?x(t.type)+x.rangeBand()/c.length*e:x(t.type)+(x.rangeBand()/c.length+5)*e+x.rangeBand()/c.length/2+3},y:function(t){return i(t.dateStart)<=s?a-n-5:y(i(t.dateStart))-5}}).text(function(t){return"interests"===t.type?t.icon+" "+t.name:t.name});if("labelClass-work"===l.attr("class")||"labelClass-education"===l.attr("class"))l.call(t,x.rangeBand());else if("labelClass-experience"===l.attr("class"))return l.call(t,x.rangeBand()/1.5)})});